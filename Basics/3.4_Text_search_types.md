### **Text Search Types trong Elasticsearch**

Elasticsearch cung cấp nhiều kiểu dữ liệu đặc biệt để xử lý và tìm kiếm văn bản (text). Mỗi kiểu dữ liệu được thiết kế để phục vụ các mục đích khác nhau, từ tìm kiếm toàn văn (full-text search) đến tự động gợi ý (autocomplete) và tìm kiếm ngữ nghĩa (semantic search).

---

### **Danh sách Text Search Types**

#### **1. `text` (và `match_only_text`)**

- **Mô tả**:
  - `text`: Dùng để lưu trữ **văn bản không có cấu trúc** (unstructured text). Thường được sử dụng cho **full-text search**.
  - `match_only_text`: Tương tự `text`, nhưng không lưu trữ giá trị gốc của trường (sử dụng ít dung lượng hơn).
- **Sử dụng**: Tìm kiếm toàn văn như các bài viết, mô tả sản phẩm, nội dung tài liệu.

**Ví dụ:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "description": { "type": "text" }
    }
  }
}

PUT /example_index/_doc/1
{
  "description": "Elasticsearch is a powerful search engine."
}
```

**Truy vấn Full-text Search:**

```json
GET /example_index/_search
{
  "query": {
    "match": {
      "description": "search engine"
    }
  }
}
```

---

#### **2. `annotated-text`**

- **Mô tả**:
  - Lưu trữ văn bản có chứa markup đặc biệt, chẳng hạn như ký hiệu để nhận dạng các thực thể (entities).
  - Ví dụ: Văn bản có thể gắn thẻ tên người, tổ chức, địa điểm.
- **Sử dụng**: Phân tích văn bản chứa markup hoặc nhận dạng thực thể có tên (Named Entity Recognition - NER).

**Ví dụ:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "content": { "type": "annotated-text" }
    }
  }
}

PUT /example_index/_doc/1
{
  "content": "Elasticsearch is developed by [Elastic](type=organization)."
}
```

**Truy vấn Full-text Search:**

```json
GET /example_index/_search
{
  "query": {
    "match": {
      "content": "Elastic"
    }
  }
}
```

---

#### **3. `completion`**

- **Mô tả**:
  - Được thiết kế cho **autocomplete** (gợi ý tự động).
  - Dựa trên gợi ý từ khóa khi người dùng gõ từng ký tự.
- **Sử dụng**: Ứng dụng tìm kiếm có chức năng gợi ý, ví dụ: thanh tìm kiếm trên các trang thương mại điện tử.

**Ví dụ:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "suggest": { "type": "completion" }
    }
  }
}

PUT /example_index/_doc/1
{
  "suggest": {
    "input": ["Elasticsearch", "Elastic", "Search Engine"]
  }
}
```

**Truy vấn Autocomplete:**

```json
GET /example_index/_search
{
  "suggest": {
    "text": "Elas",
    "my-suggestion": {
      "completion": {
        "field": "suggest"
      }
    }
  }
}
```

---

#### **4. `search_as_you_type`**

- **Mô tả**:
  - Dành cho tính năng **tìm kiếm khi gõ** (as-you-type search).
  - Tự động sinh các phiên bản khác nhau của văn bản để hỗ trợ tìm kiếm khi gõ từng ký tự.
- **Sử dụng**: Tương tự `completion`, nhưng hỗ trợ các truy vấn full-text phức tạp hơn.

**Ví dụ:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "title": { "type": "search_as_you_type" }
    }
  }
}

PUT /example_index/_doc/1
{
  "title": "Elasticsearch is a powerful tool."
}
```

**Truy vấn:**

```json
GET /example_index/_search
{
  "query": {
    "match": {
      "title": "Elas"
    }
  }
}
```

---

#### **5. `semantic_text`**

- **Mô tả**:
  - Hỗ trợ **tìm kiếm ngữ nghĩa** (semantic search).
  - Sử dụng trong các ứng dụng tìm kiếm dựa trên ý nghĩa thay vì chỉ dựa trên từ khóa.
- **Sử dụng**: Các ứng dụng tìm kiếm nâng cao với trí tuệ nhân tạo (AI) hoặc học sâu (Deep Learning).

**Ví dụ:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "content": { "type": "semantic_text" }
    }
  }
}

PUT /example_index/_doc/1
{
  "content": "Elasticsearch provides semantic search capabilities."
}
```

**Truy vấn:**

```json
GET /example_index/_semantic_search
{
  "query": {
    "text": "semantic capabilities"
  }
}
```

---

#### **6. `token_count`**

- **Mô tả**:
  - Lưu trữ số lượng **tokens** (từ hoặc cụm từ) được sinh ra sau khi phân tích văn bản.
  - Thường dùng để đếm số từ hoặc phân tích độ dài của văn bản.
- **Sử dụng**: Phân tích văn bản, kiểm tra độ dài của trường, hoặc các ứng dụng tính toán số lượng từ.

**Ví dụ:**
**Mapping:**

```json
PUT /example_index
{
  "mappings": {
    "properties": {
      "content": {
        "type": "text"
      },
      "word_count": {
        "type": "token_count",
        "analyzer": "standard"
      }
    }
  }
}
```

**Document:**

```json
PUT /example_index/_doc/1
{
  "content": "Elasticsearch is a distributed search engine.",
  "word_count": 6
}
```

**Truy vấn:**

```json
GET /example_index/_search
{
  "query": {
    "range": {
      "word_count": {
        "gte": 5
      }
    }
  }
}
```

---

### **So sánh các kiểu Text Search Types**

| **Kiểu Dữ Liệu**         | **Mô Tả**                        | **Dùng Khi Nào**                                               | **Hạn Chế**                                            |
| ------------------------ | -------------------------------- | -------------------------------------------------------------- | ------------------------------------------------------ |
| **`text`**               | Dùng cho full-text search.       | Khi cần tìm kiếm toàn văn trong nội dung văn bản.              | Không tối ưu cho autocomplete hoặc tìm kiếm ngữ nghĩa. |
| **`annotated-text`**     | Văn bản có chứa markup đặc biệt. | Khi cần nhận diện thực thể (NER) hoặc xử lý văn bản có markup. | Không phù hợp cho văn bản không chứa markup.           |
| **`completion`**         | Tối ưu cho autocomplete.         | Khi cần gợi ý tự động dựa trên từ khóa.                        | Không hỗ trợ full-text search.                         |
| **`search_as_you_type`** | Hỗ trợ tìm kiếm khi gõ.          | Khi cần tìm kiếm từng ký tự gõ và hỗ trợ truy vấn full-text.   | Ít tối ưu hơn `completion` cho autocomplete đơn giản.  |
| **`semantic_text`**      | Tìm kiếm dựa trên ngữ nghĩa.     | Khi cần ứng dụng AI hoặc tìm kiếm nâng cao dựa trên ý nghĩa.   | Yêu cầu cấu hình phức tạp hơn.                         |
| **`token_count`**        | Lưu trữ số lượng từ/tokens.      | Khi cần phân tích số lượng từ hoặc độ dài văn bản.             | Không hỗ trợ tìm kiếm nội dung văn bản.                |

---

Nếu bạn cần thêm ví dụ hoặc giải thích cụ thể hơn về một loại nào trong danh sách trên, hãy cho tôi biết nhé!
